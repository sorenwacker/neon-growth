<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Neon Growth</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            width: 100vw;
            height: 100vh;
            overflow: hidden;
            background: black;
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', sans-serif;
        }

        .controls {
            position: fixed;
            top: 60px;
            right: 20px;
            z-index: 1000;
            background: rgba(0, 0, 0, 0.85);
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            min-width: 200px;
            border: 1px solid rgba(255, 255, 255, 0.1);
        }

        .controls h3 {
            margin: 0 0 15px 0;
            font-size: 14px;
            color: rgba(255, 255, 255, 0.9);
            text-transform: uppercase;
            letter-spacing: 0.5px;
        }

        .control-group {
            margin-bottom: 15px;
        }

        .control-group label {
            display: block;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.7);
            margin-bottom: 5px;
        }

        .control-group input[type="range"] {
            width: 100%;
        }

        .control-group .value {
            display: inline-block;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.9);
            font-weight: 600;
            margin-left: 5px;
        }

        button {
            width: 100%;
            padding: 8px;
            background: rgba(255, 255, 255, 0.1);
            color: rgba(255, 255, 255, 0.9);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            margin-top: 10px;
        }

        button:hover {
            background: rgba(255, 255, 255, 0.2);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .stats {
            position: fixed;
            bottom: 20px;
            left: 20px;
            z-index: 1000;
            background: rgba(255, 255, 255, 0.9);
            padding: 15px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            font-size: 12px;
            color: #666;
        }

        .stats div {
            margin: 3px 0;
        }

        .toggle-ui {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 1001;
            background: rgba(0, 0, 0, 0.85);
            padding: 10px 15px;
            border-radius: 4px;
            cursor: pointer;
            font-size: 12px;
            color: rgba(255, 255, 255, 0.5);
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.3);
            border: 1px solid rgba(255, 255, 255, 0.1);
            transition: all 0.2s ease;
        }

        .toggle-ui:hover {
            background: rgba(0, 0, 0, 0.9);
            color: rgba(255, 255, 255, 0.9);
            border-color: rgba(255, 255, 255, 0.3);
        }

        .hidden {
            display: none;
        }
    </style>
</head>
<body>
    <div class="toggle-ui" id="toggle-ui">Show UI</div>

    <div class="controls hidden">
        <h3>Controls</h3>

        <div class="control-group">
            <label>
                Hex Size (px)
                <span class="value" id="grid-value">20</span>
            </label>
            <input type="range" id="grid" min="5" max="200" value="20" step="5">
        </div>

        <div class="control-group">
            <label>
                Max Cars
                <span class="value" id="cars-value">30</span>
            </label>
            <input type="range" id="cars" min="1" max="50" value="30" step="1">
        </div>

        <div class="control-group">
            <label>
                <input type="checkbox" id="infinite-lifetime" style="width: auto; margin-right: 5px;">
                Infinite Lifetime
            </label>
        </div>

        <div class="control-group">
            <label>
                Trace Lifetime (sec)
                <span class="value" id="trace-lifetime-value">2.0</span>
            </label>
            <input type="range" id="trace-lifetime" min="0.5" max="10" value="2.0" step="0.5">
        </div>

        <div class="control-group">
            <label>
                Fade Duration (sec)
                <span class="value" id="fade-duration-value">1.0</span>
            </label>
            <input type="range" id="fade-duration" min="0.1" max="5" value="1.0" step="0.1">
        </div>

        <div class="control-group">
            <label>
                Line Width
                <span class="value" id="width-value">10</span>
            </label>
            <input type="range" id="width" min="1" max="150" value="10" step="1">
        </div>

        <div class="control-group">
            <label>
                Step Delay (ms)
                <span class="value" id="delay-value">10</span>
            </label>
            <input type="range" id="delay" min="10" max="500" value="10" step="5">
        </div>

        <div class="control-group">
            <label>
                Spawn Delay (ms)
                <span class="value" id="spawn-delay-value">100</span>
            </label>
            <input type="range" id="spawn-delay" min="0" max="2000" value="100" step="100">
        </div>

        <div class="control-group">
            <label>
                Mutation Rate (%)
                <span class="value" id="mutation-rate-value">10</span>
            </label>
            <input type="range" id="mutation-rate" min="0" max="50" value="10" step="5">
        </div>

        <button id="reset">Reset Animation</button>
    </div>


    <script src="js/circuit-board.js"></script>

    <script>
        // Set theme to light for demo
        document.documentElement.setAttribute('data-theme', 'light');

        // Controls
        const gridSlider = document.getElementById('grid');
        const carsSlider = document.getElementById('cars');
        const infiniteLifetimeCheckbox = document.getElementById('infinite-lifetime');
        const traceLifetimeSlider = document.getElementById('trace-lifetime');
        const fadeDurationSlider = document.getElementById('fade-duration');
        const widthSlider = document.getElementById('width');
        const delaySlider = document.getElementById('delay');
        const spawnDelaySlider = document.getElementById('spawn-delay');
        const mutationRateSlider = document.getElementById('mutation-rate');
        const resetBtn = document.getElementById('reset');

        gridSlider.addEventListener('input', function() {
            document.getElementById('grid-value').textContent = this.value;
            // Grid size change requires full reset
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.destroy();
                setTimeout(() => {
                    window.circuitBoardInstance = new CircuitBoard({
                        hexSize: parseInt(gridSlider.value),
                        maxCars: parseInt(carsSlider.value),
                        infiniteLifetime: infiniteLifetimeCheckbox.checked,
                        traceLifetime: parseFloat(traceLifetimeSlider.value),
                        fadeDuration: parseFloat(fadeDurationSlider.value),
                        lineWidth: parseFloat(widthSlider.value),
                        stepDelay: parseInt(delaySlider.value),
                        spawnDelay: parseInt(spawnDelaySlider.value),
                        mutationRate: parseInt(mutationRateSlider.value) / 100
                    });
                    window.circuitBoardInstance.theme = 'light';
                }, 100);
            }
        });

        carsSlider.addEventListener('input', function() {
            document.getElementById('cars-value').textContent = this.value;
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.maxCars = parseInt(this.value);
            }
        });

        infiniteLifetimeCheckbox.addEventListener('change', function() {
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.infiniteLifetime = this.checked;
            }
        });

        traceLifetimeSlider.addEventListener('input', function() {
            document.getElementById('trace-lifetime-value').textContent = this.value;
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.traceLifetime = parseFloat(this.value);
            }
        });

        fadeDurationSlider.addEventListener('input', function() {
            document.getElementById('fade-duration-value').textContent = this.value;
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.fadeDuration = parseFloat(this.value);
            }
        });

        widthSlider.addEventListener('input', function() {
            document.getElementById('width-value').textContent = this.value;
            // Line width change requires full reset to avoid mixed widths
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.destroy();
                setTimeout(() => {
                    window.circuitBoardInstance = new CircuitBoard({
                        hexSize: parseInt(gridSlider.value),
                        maxCars: parseInt(carsSlider.value),
                        infiniteLifetime: infiniteLifetimeCheckbox.checked,
                        traceLifetime: parseFloat(traceLifetimeSlider.value),
                        fadeDuration: parseFloat(fadeDurationSlider.value),
                        lineWidth: parseFloat(widthSlider.value),
                        stepDelay: parseInt(delaySlider.value),
                        spawnDelay: parseInt(spawnDelaySlider.value),
                        mutationRate: parseInt(mutationRateSlider.value) / 100
                    });
                    window.circuitBoardInstance.theme = 'light';
                }, 100);
            }
        });

        delaySlider.addEventListener('input', function() {
            document.getElementById('delay-value').textContent = this.value;
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.stepDelay = parseInt(this.value);
            }
        });

        spawnDelaySlider.addEventListener('input', function() {
            document.getElementById('spawn-delay-value').textContent = this.value;
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.spawnDelay = parseInt(this.value);
            }
        });

        mutationRateSlider.addEventListener('input', function() {
            document.getElementById('mutation-rate-value').textContent = this.value;
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.mutationRate = parseInt(this.value) / 100; // Convert % to decimal
            }
        });

        resetBtn.addEventListener('click', function() {
            if (window.circuitBoardInstance) {
                window.circuitBoardInstance.destroy();
            }
            setTimeout(() => {
                window.circuitBoardInstance = new CircuitBoard({
                    hexSize: parseInt(gridSlider.value),
                    maxCars: parseInt(carsSlider.value),
                    infiniteLifetime: infiniteLifetimeCheckbox.checked,
                    traceLifetime: parseFloat(traceLifetimeSlider.value),
                    fadeDuration: parseFloat(fadeDurationSlider.value),
                    lineWidth: parseFloat(widthSlider.value),
                    stepDelay: parseInt(delaySlider.value),
                    spawnDelay: parseInt(spawnDelaySlider.value),
                    mutationRate: parseInt(mutationRateSlider.value) / 100
                });
                window.circuitBoardInstance.theme = 'light';
            }, 100);
        });

        // Toggle UI visibility
        const toggleBtn = document.getElementById('toggle-ui');
        const controlsBox = document.querySelector('.controls');
        const statsBox = document.querySelector('.stats');
        let uiVisible = false; // Start hidden

        toggleBtn.addEventListener('click', function() {
            uiVisible = !uiVisible;
            if (uiVisible) {
                controlsBox.classList.remove('hidden');
                if (statsBox) statsBox.classList.remove('hidden');
                toggleBtn.textContent = 'Hide UI';
            } else {
                controlsBox.classList.add('hidden');
                if (statsBox) statsBox.classList.add('hidden');
                toggleBtn.textContent = 'Show UI';
            }
        });

        // Initialize animation on load
        window.circuitBoardInstance = new CircuitBoard({
            hexSize: parseInt(gridSlider.value),
            maxCars: parseInt(carsSlider.value),
            lineWidth: parseFloat(widthSlider.value),
            stepDelay: parseInt(delaySlider.value),
            spawnDelay: parseInt(spawnDelaySlider.value),
            mutationRate: parseInt(mutationRateSlider.value) / 100
        });
        window.circuitBoardInstance.theme = 'light';

    </script>
</body>
</html>
